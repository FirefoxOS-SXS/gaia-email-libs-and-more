<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <base href="resource://jid1-reoZ1pC7LQZcEA-at-jetpack/jetpack-tcp-imap-demo/data/" />
    <title>IMAP</title>
    <style type="text/css">
      html {
        font-family: "Lucida Grande", Verdana, sans-serif;
        font-size: 9pt;
      }
    </style>
  <link rel="shortcut icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAAXNSR0IArs4c6QAAABhQTFRFIEqHLjQ2iIqF09fP7u7s9XkA/K8+////Ga9XSQAAAIJJREFUKM/F0DEOwjAMhWFvnasOzOQIuHfgBuUaVAX9169jJxUkgrWOlOR9sZeIiCBl80sHCMhzyKevf9CNfAJ1AHo4mn4CTfWwjl91MdB7fX1phuTyjpwMNI0zLA/PaoCmabYOz2RAryaRA7iZRC6wmUQukCVyBZPIB7DRAKdD84U7Lb2fKUPDzZ8AAAAASUVORK5CYII=" />
  <script type="text/javascript" src="lib/require.js"></script>
  <script>//<![CDATA[
    // Only add setZeroTimeout to the window object, and hide everything
    // else in a closure.
    (function() {
        var timeouts = [];
        var messageName = "zero-timeout-message";

        // Like setTimeout, but only takes a function argument.  There's
        // no time argument (always zero) and no arguments (you have to
        // use a closure).
        function setZeroTimeout(fn) {
            timeouts.push(fn);
            window.postMessage(messageName, "*");
        }

        function handleMessage(event) {
            if (event.source == window && event.data == messageName) {
                event.stopPropagation();
                if (timeouts.length > 0) {
                    var fn = timeouts.shift();
                    fn();
                }
            }
        }

        window.addEventListener("message", handleMessage, true);

        // Add the one thing we want added to the window object.
        window.setZeroTimeout = setZeroTimeout;
    })();
    var process = {
      immediate: false,
      nextTick: function(cb) {
        if (this.immediate)
          cb();
        else
          window.setZeroTimeout(cb);
      }
    };
    require.onError = function(ex) {
      console.error("RequireJS load error:", ex, ex.stack);
      throw ex;
    }
    require({
      baseUrl: "resource://jid1-reoZ1pC7LQZcEA-at-jetpack/jetpack-tcp-imap-demo/data/",
      paths: {
        "q": "lib/q",
        "text": "lib/text",
        // silly shims
        "event-queue": "lib/js-shims/event-queue",
        "microtime": "lib/js-shims/microtime",
        "path": "lib/js-shims/path",

        "imap": "lib/imap",

        "rdplat": "lib/rdplat",
        "rdcommon": "lib/rdcommon",
        "rdimap": "lib/rdimap",

        "buffer": "lib/node-buffer",
        "crypto": "lib/node-crypto",

        "assert": "deps/browserify-builtins/assert",
        "events": "deps/browserify-builtins/events",
        "stream": "deps/browserify-builtins/stream",
        "util": "deps/browserify-builtins/util",

      },
      packages: [
        { name: "mimelib", location: "deps/mimelib", main: "index" },
        { name: "iconv", location: "deps/iconv-lite", main: "index" },
        { name: "mailparser", location: "deps/mailparser/lib" },
      ],
      text: {
        // make the text plugin always use XHR because it gets confused by
        //  the protocol/origin change or what not.
        useXhr: function () { return true; },
      }
    },

    ["deps/encoding.js", "buffer"],
function(ignored, $buffer) {
window.Buffer = $buffer.Buffer;
require(
["rdimap/imapclient/same-frame-setup", /*"rdimap/devui/app"*/],
function(setup) {
  window.goSync = function(accountDef) {
    setup.goSync(accountDef);
  };
});
});
//]]></script>
</head>
<body id="body">
</body>
</html>
